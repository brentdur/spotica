{% extends "micro/base.html" %}
{% load humanize %}
{% load staticfiles %}

{% block sidebar %}
  <img src="{% static "micro/images/user.png" %}" alt="Generic User"/>
  <br>
  <p>{{ user.username }}</p>
{% endblock %}

{% block content %}
  <div>
    <form class="form" method="post" action="{% url 'micro:post' %}">
      {% csrf_token %}
      <div class="editor">
        <div class="editor__container">
          <div class="editor__input">
            <textarea
              name="text"
              class="editorInput__field"
              placeholder="What's on your mind?"
              rows="2"></textarea>

            <!-- TODO: replace max post length with a constant -->
            <p class="editorInput__counter">0/140</p>
          </div>
          <div class="editor__songChoice"></div>
          <div class="postTypes">
            <button type="button" class="button postType">
              <i class="material-icons button__icon postType__icon">music_note</i>
              Add music
            </button>
          </div>

          <div class="editor__overlay"></div>
        </div>

        <input type="submit" class="primary button editor__submit" value="Post">
      </div>
    </form>

    <div class="feed">
    </div>
  </div>

  <div id="status">
    {% if my_post %}
     {{ my_post.text }} ({{ my_post.pub_date|naturaltime }})
    {% endif %}
  </div>

  <div>
    {% if post_list %}
      <table id="postlist">
        {% for post in post_list %}
          <tr>
            <td>
              <img src="{% static "micro/images/user_s.png" %}" alt="Generic User"/>
            </td>
            <td>
              {{ post.text }}
            </td>
          </tr>
          <tr>
            <td></td>
            <td>
              <a href="{% url 'micro:stream' post.user_id %}">
                {{ post.user.username }}
              </a>
              ({{ post.pub_date|naturaltime }})
            </td>
          </tr>
        {% endfor %}
      </table>
    {% else %}
      <p>No posts are available.</p>
    {% endif %}
  </div>
{% endblock %}
